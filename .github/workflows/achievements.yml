name: 🚦 SignSprinters Achievement Badges

on:
  push:
    branches: [ main, master, develop ]
  pull_request:
    branches: [ main, master, develop ]

jobs:
  generate-achievements:
    runs-on: ubuntu-latest
    
    steps:
    - name: 🚀 Checkout Repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0  # Get full history for commit counting
    
    - name: 📊 Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
    
    - name: 🏆 Generate SignSprinters Badges
      run: node .github/scripts/generate-signsprinters-badges.js
      
    - name: 📝 Commit Achievement Updates
      run: |
        git config --local user.email "signsprinters-bot@github.com"
        git config --local user.name "SignSprinters Achievement Bot"
        git add -A
        if ! git diff --staged --quiet; then
          git commit -m "🏆 Update SignSprinters achievement badges [automated]"
          git push
        else
          echo "No changes to commit"
        fi
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
